%% HW 3 Problem 1

cT = [0 17.0    21.0    26.0    32.0
0.10  0.0818  0.0910  0.0870  0.0950
0.15  0.0795  0.0910  0.0882  0.0933
0.20  0.0770  0.0900  0.0889  0.0925
0.25  0.0742  0.0884  0.0890  0.0915
0.30  0.0702  0.0860  0.0890  0.0908
0.35  0.0660  0.0832  0.0886  0.0898
0.40  0.0612  0.0801  0.0880  0.0888
0.45  0.0560  0.0757  0.0864  0.0882
0.50  0.0500  0.0708  0.0845  0.0880
0.55  0.0416  0.0655  0.0817  0.0877
0.60  0.0330  0.0591  0.0780  0.0870
0.65  0.0248  0.0520  0.0732  0.0858
0.70  0.0175  0.0450  0.0672  0.0830
0.75  0.0105  0.0368  0.0610  0.0800
0.80 -0.0010  0.0294  0.0547  0.0752
0.85 -0.0010  0.0224  0.0483  0.0703
0.90 -0.0010 -0.0010  0.0416  0.0651
0.95 -0.0010 -0.0010  0.0349  0.0591
1.00 -0.0010 -0.0010  0.0280  0.0530
1.05 -0.0010 -0.0010  0.0211  0.0467
1.10 -0.0010 -0.0010  0.0142  0.0402
1.15 -0.0010 -0.0010  0.0072  0.0337
1.20 -0.0010 -0.0010 -0.0010  0.0270
1.25 -0.0010 -0.0010 -0.0010  0.0201
1.30 -0.0010 -0.0010 -0.0010  0.0130
1.35 -0.0010 -0.0010 -0.0010  0.0056];
%1.40 -0.0010 -0.0010 -0.0010 -0.0010];

cP = [0 17.0    21.0    26.0    32.0
0.10  0.0400  0.0520  0.0769  0.1055
0.15  0.0400  0.0521  0.0755  0.1029
0.20  0.0400  0.0523  0.0740  0.1000
0.25  0.0400  0.0525  0.0720  0.0972
0.30  0.0397  0.0526  0.0695  0.0950
0.35  0.0392  0.0527  0.0676  0.0922
0.40  0.0384  0.0528  0.0663  0.0900
0.45  0.0370  0.0523  0.0656  0.0880
0.50  0.0348  0.0513  0.0658  0.0863
0.55  0.0302  0.0498  0.0659  0.0852
0.60  0.0255  0.0472  0.0656  0.0839
0.65  0.0208  0.0436  0.0646  0.0835
0.70  0.0164  0.0394  0.0620  0.0822
0.75  0.0115  0.0345  0.0588  0.0814
0.80  0.0000  0.0294  0.0551  0.0791
0.85  0.0000  0.0238  0.0510  0.0766
0.90  0.0000  0.0000  0.0461  0.0739
0.95  0.0000  0.0000  0.0408  0.0700
1.00  0.0000  0.0000  0.0349  0.0652
1.05  0.0000  0.0000  0.0284  0.0597
1.10  0.0000  0.0000  0.0214  0.0536
1.15  0.0000  0.0000  0.0140  0.0469
1.20  0.0000  0.0000  0.0000  0.0398
1.25  0.0000  0.0000  0.0000  0.0321
1.30  0.0000  0.0000  0.0000  0.0240
1.35  0.0000  0.0000  0.0000  0.0157]

eta = cT(2:end,2:end)./cP(2:end,2:end).*cT(2:end,1);

figure; hold on; grid on;
plot(cT(2:end,1),eta(:,1));
plot(cT(2:end,1),eta(:,2));
plot(cT(2:end,1),eta(:,3));
plot(cT(2:end,1),eta(:,4));
xlabel('Advance Ratio[1/rev]');
ylabel('Propeller Efficiency');
legend('Blade Pitch=17[deg]','Blade Pitch=21[deg]','Blade Pitch=26[deg]','Blade Pitch=32[deg]');
title('Problem 1');

%% Problem 2
h = [0:20]';
g = 32.2;
TSL = 518.7;
a = -.00356;
R = 1716;
PSL = 230;
rho = 0.076474*(1+a*h*1000/TSL).^(-(1+g/(a*R)));

% Lycoming:
PLy = [230 224 216 208 200 192 186 180 174 168 162 155 150 144 138 132 126 122 116 112 108]';

% Model 1:
P1 = PSL*(rho/rho(1));

% Model 2:
P2 = PSL*(rho/rho(1)-1/7.75*(1-rho/rho(1)));

figure; hold on; grid on;
plot(PLy,h);
plot(P1,h);
plot(P2,h);
legend('Lycoming Model','Model 1','Model 2');
xlabel('Available Power[hp]');
ylabel('Altitude[Kft]');
title('Problem 2');

%% Problem 3
m = 8.6;
a = 3; b = 4; c = .5;

PlaneCM = [41;0;36.5]/12;
RCM = [48;48;59.4]/12;
LCM = [48;-48;59.4]/12;

ITank = m/12*diag([b^2+c^2,c^2+a^2,a^2+b^2]);
ICM = @(disp,m) m*[disp(2)^2+disp(3)^2,-disp(1)*disp(2),-disp(1)*disp(3);-disp(1)*disp(2),disp(1)^2+disp(3)^2,-disp(2)*disp(3);-disp(1)*disp(3),-disp(2)*disp(3),disp(1)^2+disp(2)^2]; %Translation matrix

% Both Full:
Itot = ITank+ICM(PlaneCM-RCM,m)+ITank+ICM(PlaneCM-LCM,m)

% One Full:
Itot = ITank+ICM(PlaneCM-RCM,m)
